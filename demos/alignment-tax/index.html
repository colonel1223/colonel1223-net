<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8"><meta name="viewport" content="width=device-width,initial-scale=1.0">
<title>Alignment Tax Quantifier — Interactive Demo</title>
<script src="https://cdnjs.cloudflare.com/ajax/libs/plotly.js/2.27.0/plotly.min.js"></script>
<link href="https://fonts.googleapis.com/css2?family=JetBrains+Mono:wght@400;600;700&family=Source+Serif+4:ital,opsz,wght@0,8..60,300;0,8..60,500;0,8..60,700;1,8..60,400&display=swap" rel="stylesheet">
<style>
:root{--bg:#0a0e17;--sf:#111827;--sf2:#1a2235;--bd:#1e2d45;--tx:#e2e8f0;--dm:#8892a4;--a1:#f59e0b;--a2:#3b82f6;--a3:#10b981;--m:'JetBrains Mono',monospace;--s:'Source Serif 4',Georgia,serif}
*{margin:0;padding:0;box-sizing:border-box}body{background:var(--bg);color:var(--tx);font-family:var(--m);line-height:1.6}
header{padding:3rem 2rem 2rem;max-width:1200px;margin:0 auto}
header .tag{font-size:.65rem;letter-spacing:.2em;text-transform:uppercase;color:var(--a1);background:rgba(245,158,11,.1);padding:.3rem .8rem;border-radius:2px;display:inline-block;border:1px solid rgba(245,158,11,.2)}
header h1{font-family:var(--s);font-size:2.8rem;font-weight:700;margin:1rem 0 .5rem;letter-spacing:-.02em}header h1 span{color:var(--a1)}
header p{font-size:.85rem;color:var(--dm);max-width:680px}
header .meta{display:flex;gap:2rem;margin-top:1.5rem;font-size:.7rem;color:var(--dm)}header .meta a{color:var(--a2);text-decoration:none}
.ct{max-width:1200px;margin:0 auto;padding:0 2rem 4rem}
.sl{font-size:.6rem;letter-spacing:.25em;text-transform:uppercase;color:var(--a1);margin-bottom:.5rem}
.st{font-family:var(--s);font-size:1.5rem;font-weight:500;margin-bottom:.5rem}
.sd{font-size:.75rem;color:var(--dm);margin-bottom:1.5rem;max-width:600px}
.g{display:grid;gap:1.5rem;margin-bottom:3rem}.g3{grid-template-columns:1fr 1fr 1fr}.g2{grid-template-columns:1fr 1fr}
@media(max-width:768px){.g2,.g3{grid-template-columns:1fr}}
.c{background:var(--sf);border:1px solid var(--bd);border-radius:4px;padding:1.5rem;position:relative;overflow:hidden}
.c::before{content:'';position:absolute;top:0;left:0;right:0;height:1px;background:linear-gradient(90deg,transparent,var(--a1),transparent);opacity:.3}
.c h3{font-size:.75rem;letter-spacing:.1em;text-transform:uppercase;color:var(--dm);margin-bottom:1rem}
.stat{font-family:var(--s);font-size:2.5rem;font-weight:700;line-height:1}
.stat.gn{color:var(--a3)}.stat.am{color:var(--a1)}.stat.bl{color:var(--a2)}
.stat-l{font-size:.65rem;color:var(--dm);margin-top:.3rem}
.ctrl{display:flex;gap:1rem;flex-wrap:wrap;align-items:center;margin-bottom:1rem}
.ctrl label{font-size:.7rem;color:var(--dm)}
.ctrl select,.ctrl input[type=range]{background:var(--sf2);border:1px solid var(--bd);color:var(--tx);padding:.4rem .6rem;border-radius:3px;font-family:var(--m);font-size:.75rem}
.rv{font-size:.7rem;color:var(--a1);min-width:3rem}
table{width:100%;border-collapse:collapse;font-size:.75rem}
table th{text-align:left;padding:.6rem 1rem;border-bottom:1px solid var(--bd);color:var(--dm);font-weight:600;font-size:.65rem;letter-spacing:.1em;text-transform:uppercase}
table td{padding:.6rem 1rem;border-bottom:1px solid rgba(30,45,69,.5)}
.meth{background:var(--sf);border:1px solid var(--bd);border-radius:4px;padding:2rem;margin-top:3rem}
.meth h3{font-family:var(--s);font-size:1.1rem;margin-bottom:1rem}
.meth p{font-size:.8rem;color:var(--dm);line-height:1.8;margin-bottom:1rem}
.meth code{background:var(--sf2);padding:.1rem .4rem;border-radius:2px;font-size:.75rem;color:var(--a1)}
footer{text-align:center;padding:2rem;font-size:.65rem;color:var(--dm);border-top:1px solid var(--bd);margin-top:2rem}footer a{color:var(--a2);text-decoration:none}
</style>
</head>
<body>
<header>
<div class="tag">AI Safety Research · Interactive Demo</div>
<h1>Alignment Tax <span>Quantifier</span></h1>
<p>Empirically measure and optimize the performance cost of safety constraints using Shapley value attribution and multi-objective Pareto optimization.</p>
<div class="meta"><span>Spencer Cottrell</span><a href="https://github.com/colonel1223/alignment-tax-quantifier">GitHub →</a><span>Python 3.10+ · PyTorch 2.0+</span></div>
</header>
<div class="ct">
<div class="sl">Results Summary</div><div class="st">Alignment Tax Reduction</div>
<div class="sd">Average across GPT-4, Claude-3, and Llama-3-70B with five constraint types.</div>
<div class="g g3">
<div class="c"><h3>Naive Tax</h3><div class="stat am" id="sn">6.2%</div><div class="stat-l">Before optimization</div></div>
<div class="c"><h3>Optimized Tax</h3><div class="stat gn" id="so">2.4%</div><div class="stat-l">After Pareto optimization</div></div>
<div class="c"><h3>Reduction</h3><div class="stat bl" id="sr">62%</div><div class="stat-l">Maintaining safety guarantees</div></div>
</div>

<div class="sl">Interactive Visualization</div><div class="st">Pareto Frontier Explorer</div>
<div class="sd">Explore trade-offs between performance and safety. Each point is a constraint configuration found by NSGA-II.</div>
<div class="c">
<div class="ctrl">
<div><label>Model:</label><select id="ms" onchange="up()"><option value="gpt4">GPT-4</option><option value="claude3">Claude-3</option><option value="llama3">Llama-3-70B</option></select></div>
<div><label>Safety Min:</label><input type="range" id="st2" min="70" max="99" value="85" oninput="up()"><span class="rv" id="sv">85%</span></div>
<div><label>Generations:</label><select id="gs" onchange="up()"><option value="10">10</option><option value="25">25</option><option value="50" selected>50</option><option value="100">100</option></select></div>
</div>
<div id="pc" style="min-height:400px"></div>
</div>

<div style="margin-top:3rem"><div class="sl">Causal Attribution</div><div class="st">Shapley Value Decomposition</div>
<div class="sd">Each constraint's causal contribution to alignment tax via Monte Carlo Shapley values.</div></div>
<div class="g g2">
<div class="c"><div id="sc" style="min-height:350px"></div></div>
<div class="c"><h3>Attribution Table</h3>
<table id="stb"><thead><tr><th>Constraint</th><th>Tax %</th><th>Share</th><th>95% CI</th></tr></thead><tbody></tbody></table>
</div>
</div>

<div style="margin-top:3rem"><div class="sl">Statistical Rigor</div><div class="st">Bootstrap Confidence Intervals</div>
<div class="sd">1,000 bootstrap resamples providing non-parametric confidence intervals.</div></div>
<div class="c">
<div class="ctrl">
<div><label>Samples:</label><select id="bn" onchange="ub()"><option value="200">200</option><option value="500">500</option><option value="1000" selected>1,000</option></select></div>
<div><label>Confidence:</label><select id="cl" onchange="ub()"><option value="0.90">90%</option><option value="0.95" selected>95%</option><option value="0.99">99%</option></select></div>
</div>
<div id="bc" style="min-height:400px"></div>
</div>

<div style="margin-top:3rem"><div class="sl">Benchmarks</div><div class="st">Model Comparison</div></div>
<div class="c"><table>
<thead><tr><th>Model</th><th>Naive</th><th>Optimized</th><th>Reduction</th><th>95% CI</th><th>Pareto Pts</th><th>Latency</th></tr></thead>
<tbody>
<tr><td>GPT-4</td><td style="color:var(--a1)">6.0%</td><td style="color:var(--a3)">2.1%</td><td style="color:var(--a2)">65%</td><td>[1.8,2.5]</td><td>47</td><td>+3.2ms</td></tr>
<tr><td>Claude-3</td><td style="color:var(--a1)">4.9%</td><td style="color:var(--a3)">1.8%</td><td style="color:var(--a2)">63%</td><td>[1.4,2.2]</td><td>52</td><td>+2.8ms</td></tr>
<tr><td>Llama-3-70B</td><td style="color:var(--a1)">7.8%</td><td style="color:var(--a3)">3.2%</td><td style="color:var(--a2)">59%</td><td>[2.7,3.8]</td><td>38</td><td>+4.1ms</td></tr>
<tr><td>Mistral-7B</td><td style="color:var(--a1)">9.1%</td><td style="color:var(--a3)">4.0%</td><td style="color:var(--a2)">56%</td><td>[3.4,4.7]</td><td>31</td><td>+5.3ms</td></tr>
<tr><td>Gemma-2-27B</td><td style="color:var(--a1)">5.5%</td><td style="color:var(--a3)">2.0%</td><td style="color:var(--a2)">64%</td><td>[1.6,2.4]</td><td>44</td><td>+3.0ms</td></tr>
</tbody></table></div>

<div class="meth"><h3>Methodology</h3>
<p><strong>Tax Definition:</strong> τ(M,C) = (P(M) − P(M|C)) / P(M) × 100%, where P is performance and C is the constraint set.</p>
<p><strong>Shapley Attribution:</strong> Monte Carlo approximation (1,000 permutations) of cooperative game-theoretic Shapley values for fair constraint attribution.</p>
<p><strong>Pareto Optimization:</strong> NSGA-II (pop=100, 50 gen) with tournament selection, SBX crossover, polynomial mutation. Objectives: maximize performance, maximize safety coverage, minimize latency.</p>
<p><strong>Bootstrap CIs:</strong> Percentile-based intervals from B=1,000 resamples with parallel processing.</p>
</div>
</div>
<footer>Spencer Cottrell · <a href="https://github.com/colonel1223">github.com/colonel1223</a> · MIT License · 2026</footer>
<script>
function R(s){let x=s;return()=>{x=(x*16807)%2147483647;return(x-1)/2147483646}}
const M={gpt4:{n:6.0,o:2.1,p:47,nm:'GPT-4'},claude3:{n:4.9,o:1.8,p:52,nm:'Claude-3'},llama3:{n:7.8,o:3.2,p:38,nm:'Llama-3-70B'}};
const SD=[{n:'Value Alignment',t:2.1,l:1.7,h:2.5},{n:'Content Filter',t:1.5,l:1.2,h:1.9},{n:'Output Bounds',t:0.8,l:0.5,h:1.1},{n:'Refusal Logic',t:1.0,l:0.7,h:1.3},{n:'Toxicity Guard',t:0.8,l:0.5,h:1.2}];
const P={bg:'#111827',paper:'#111827',grid:'#1e2d45',text:'#8892a4'};
const L={paper_bgcolor:P.paper,plot_bgcolor:P.bg,font:{family:'JetBrains Mono',color:P.text,size:11},margin:{l:60,r:30,t:40,b:50}};
function up(){
const m=document.getElementById('ms').value,th=+document.getElementById('st2').value,g=+document.getElementById('gs').value;
document.getElementById('sv').textContent=th+'%';
const r=R(m==='gpt4'?42:m==='claude3'?137:256),d=M[m],np=Math.round(d.p*(g/50));
const pf=[],sf=[],dom_p=[],dom_s=[];
for(let i=0;i<np;i++){const t=i/(np-1);pf.push(Math.min(((1-d.n/100)+t*(d.n-d.o)/100+(r()-.5)*.008)*100,100));sf.push(Math.max(Math.min((0.99-t*.25+(r()-.5)*.03)*100,100),70))}
for(let i=0;i<np*.6;i++){dom_p.push(88+r()*10);dom_s.push(72+r()*20)}
Plotly.react('pc',[
{x:dom_p,y:dom_s,mode:'markers',name:'Dominated',marker:{color:'rgba(59,130,246,.2)',size:5},hoverinfo:'x+y'},
{x:pf,y:sf,mode:'markers+lines',name:'Pareto Front',marker:{color:'#f59e0b',size:9,line:{color:'#0a0e17',width:1}},line:{color:'rgba(245,158,11,.4)',width:1,dash:'dot'},hovertemplate:'Perf: %{x:.1f}%<br>Safety: %{y:.1f}%<extra></extra>'},
{x:[85,100],y:[th,th],mode:'lines',name:'Threshold',line:{color:'#10b981',width:1.5,dash:'dash'}}
],{...L,title:{text:`${d.nm} — Pareto Frontier (${g} gen)`,font:{size:13}},xaxis:{title:'Performance (%)',gridcolor:P.grid,range:[85,100.5]},yaxis:{title:'Safety Coverage (%)',gridcolor:P.grid,range:[68,101]},showlegend:true,legend:{x:.02,y:.02,bgcolor:'rgba(17,24,39,.8)',font:{size:10}}},{responsive:true,displayModeBar:false});
document.getElementById('sn').textContent=d.n.toFixed(1)+'%';
document.getElementById('so').textContent=d.o.toFixed(1)+'%';
document.getElementById('sr').textContent=Math.round((1-d.o/d.n)*100)+'%';
}
function iS(){
const tot=SD.reduce((s,d)=>s+d.t,0);
Plotly.newPlot('sc',[{y:SD.map(d=>d.n),x:SD.map(d=>d.t),type:'bar',orientation:'h',marker:{color:['#f59e0b','#3b82f6','#10b981','#8b5cf6','#ec4899']},error_x:{type:'data',symmetric:false,array:SD.map(d=>d.h-d.t),arrayminus:SD.map(d=>d.t-d.l),color:P.text,thickness:1.5,width:4}}],{...L,title:{text:'Shapley Value Attribution (φᵢ)',font:{size:13}},xaxis:{title:'Tax Contribution (%)',gridcolor:P.grid},yaxis:{automargin:true},margin:{l:120,r:30,t:50,b:50}},{responsive:true,displayModeBar:false});
const tb=document.querySelector('#stb tbody');
SD.forEach(d=>{tb.innerHTML+=`<tr><td>${d.n}</td><td style="color:var(--a1)">${d.t.toFixed(1)}%</td><td>${(d.t/tot*100).toFixed(0)}%</td><td>[${d.l},${d.h}]</td></tr>`});
}
function ub(){
const n=+document.getElementById('bn').value,al=1-parseFloat(document.getElementById('cl').value),r=R(7),s=[];
for(let i=0;i<n;i++){const u1=r(),u2=r();s.push(6.2+Math.sqrt(-2*Math.log(u1))*Math.cos(2*Math.PI*u2)*1.1)}
s.sort((a,b)=>a-b);const cl=s[Math.floor(n*al/2)],ch=s[Math.floor(n*(1-al/2))],mn=s.reduce((a,b)=>a+b,0)/n;
Plotly.react('bc',[{x:s,type:'histogram',nbinsx:40,marker:{color:'rgba(59,130,246,.5)',line:{color:'#3b82f6',width:.5}}}],{...L,title:{text:`Bootstrap (B=${n})`,font:{size:13}},xaxis:{title:'Tax Estimate (%)',gridcolor:P.grid},yaxis:{title:'Count',gridcolor:P.grid},shapes:[{type:'line',x0:cl,x1:cl,y0:0,y1:1,yref:'paper',line:{color:'#f59e0b',width:2,dash:'dash'}},{type:'line',x0:ch,x1:ch,y0:0,y1:1,yref:'paper',line:{color:'#f59e0b',width:2,dash:'dash'}},{type:'line',x0:mn,x1:mn,y0:0,y1:1,yref:'paper',line:{color:'#10b981',width:2}},{type:'rect',x0:cl,x1:ch,y0:0,y1:1,yref:'paper',fillcolor:'rgba(245,158,11,.08)',line:{width:0}}],annotations:[{x:cl,y:1.02,yref:'paper',text:`Low: ${cl.toFixed(2)}%`,showarrow:false,font:{size:10,color:'#f59e0b'}},{x:ch,y:1.02,yref:'paper',text:`High: ${ch.toFixed(2)}%`,showarrow:false,font:{size:10,color:'#f59e0b'}},{x:mn,y:1.06,yref:'paper',text:`Mean: ${mn.toFixed(2)}%`,showarrow:false,font:{size:10,color:'#10b981'}}]},{responsive:true,displayModeBar:false});
}
up();iS();ub();
</script>
</body></html>
