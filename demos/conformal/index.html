<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8"><meta name="viewport" content="width=device-width,initial-scale=1.0">
<title>Conformal Prediction for Multi-Modal AI ‚Äî Interactive Demo</title>
<script src="https://cdnjs.cloudflare.com/ajax/libs/plotly.js/2.27.0/plotly.min.js"></script>
<link href="https://fonts.googleapis.com/css2?family=JetBrains+Mono:wght@400;600;700&family=Source+Serif+4:ital,opsz,wght@0,8..60,300;0,8..60,500;0,8..60,700;1,8..60,400&display=swap" rel="stylesheet">
<style>
:root{--bg:#080c14;--sf:#0f1623;--sf2:#16202f;--bd:#1c2a42;--tx:#e2e8f0;--dm:#7b8ba2;--a1:#10b981;--a2:#6366f1;--w:#f59e0b;--d:#ef4444;--m:'JetBrains Mono',monospace;--s:'Source Serif 4',Georgia,serif}
*{margin:0;padding:0;box-sizing:border-box}body{background:var(--bg);color:var(--tx);font-family:var(--m);line-height:1.6}
header{padding:3rem 2rem 2rem;max-width:1200px;margin:0 auto}
header .tag{font-size:.65rem;letter-spacing:.2em;text-transform:uppercase;color:var(--a1);background:rgba(16,185,129,.08);padding:.3rem .8rem;border-radius:2px;display:inline-block;border:1px solid rgba(16,185,129,.15)}
header h1{font-family:var(--s);font-size:2.6rem;font-weight:700;margin:1rem 0 .5rem}header h1 span{color:var(--a1)}
header p{font-size:.85rem;color:var(--dm);max-width:700px}
header .mt{display:flex;gap:2rem;margin-top:1.5rem;font-size:.7rem;color:var(--dm)}header .mt a{color:var(--a2);text-decoration:none}
.ct{max-width:1200px;margin:0 auto;padding:0 2rem 4rem}
.sl{font-size:.6rem;letter-spacing:.25em;text-transform:uppercase;color:var(--a1);margin-bottom:.5rem}
.st{font-family:var(--s);font-size:1.5rem;font-weight:500;margin-bottom:.5rem}
.sd{font-size:.75rem;color:var(--dm);margin-bottom:1.5rem;max-width:600px}
.g{display:grid;gap:1.5rem;margin-bottom:3rem}.g2{grid-template-columns:1fr 1fr}.g4{grid-template-columns:1fr 1fr 1fr 1fr}
@media(max-width:768px){.g2,.g4{grid-template-columns:1fr}}
.c{background:var(--sf);border:1px solid var(--bd);border-radius:4px;padding:1.5rem;position:relative;overflow:hidden}
.c::before{content:'';position:absolute;top:0;left:0;right:0;height:1px;background:linear-gradient(90deg,transparent,var(--a1),transparent);opacity:.25}
.c h3{font-size:.7rem;letter-spacing:.1em;text-transform:uppercase;color:var(--dm);margin-bottom:.8rem}
.stat{font-family:var(--s);font-size:2.2rem;font-weight:700;line-height:1}
.stat.gn{color:var(--a1)}.stat.w{color:var(--w)}.stat.d{color:var(--d)}
.stat-l{font-size:.65rem;color:var(--dm);margin-top:.3rem}
.ctrl{display:flex;gap:1rem;flex-wrap:wrap;align-items:center;margin-bottom:1rem}
.ctrl label{font-size:.7rem;color:var(--dm)}
.ctrl select,.ctrl input[type=range]{background:var(--sf2);border:1px solid var(--bd);color:var(--tx);padding:.4rem .6rem;border-radius:3px;font-family:var(--m);font-size:.75rem;cursor:pointer}
.rv{font-size:.7rem;color:var(--a1);min-width:3rem}
table{width:100%;border-collapse:collapse;font-size:.75rem}
table th{text-align:left;padding:.5rem .8rem;border-bottom:1px solid var(--bd);color:var(--dm);font-weight:600;font-size:.65rem;letter-spacing:.08em;text-transform:uppercase}
table td{padding:.5rem .8rem;border-bottom:1px solid rgba(28,42,66,.5)}
.th{background:var(--sf);border:1px solid var(--bd);border-radius:4px;padding:2rem;margin-top:3rem}
.th h3{font-family:var(--s);font-size:1.1rem;margin-bottom:1rem}
.th p{font-size:.8rem;color:var(--dm);line-height:1.8;margin-bottom:1rem}
.th code{background:var(--sf2);padding:.1rem .4rem;border-radius:2px;font-size:.75rem;color:var(--a1)}
.eq{text-align:center;font-family:var(--s);font-size:1.1rem;color:var(--tx);margin:1.5rem 0}
footer{text-align:center;padding:2rem;font-size:.65rem;color:var(--dm);border-top:1px solid var(--bd);margin-top:2rem}footer a{color:var(--a2);text-decoration:none}
</style>
</head>
<body><a href="../.." style="position:fixed;top:12px;left:14px;font-family:'JetBrains Mono',monospace;font-size:9px;letter-spacing:2px;color:#4a4a5a;text-decoration:none;z-index:9999;text-transform:uppercase;border:1px solid #1e1e24;padding:4px 12px;background:#060608;border-radius:2px" onmouseover="this.style.color='#ccccdd'" onmouseout="this.style.color='#4a4a5a'">‚Üê BACK</a>
<header>
<div class="tag">Uncertainty Quantification ¬∑ Interactive Demo</div>
<h1>Conformal Prediction for <span>Multi-Modal AI</span></h1>
<p>Distribution-free, finite-sample coverage guarantees for any classifier. First production-ready implementation of adaptive conformal inference with multi-modal fusion.</p>
<div class="mt"><span>Spencer Cottrell</span><a href="https://github.com/colonel1223/conformal-multimodal">GitHub ‚Üí</a><span>Python 3.10+ ¬∑ PyTorch 2.0+</span></div>
</header>
<div class="ct">
<div class="sl">Coverage Guarantees</div><div class="st">Why Conformal Prediction Matters</div>
<div class="sd">Standard softmax "confidence" is misleading. Conformal prediction provides mathematically guaranteed coverage.</div>
<div class="g g4">
<div class="c"><h3>Softmax</h3><div class="stat d">68%</div><div class="stat-l">Claims 90%, achieves 68%</div></div>
<div class="c"><h3>Temp Scaling</h3><div class="stat w">76%</div><div class="stat-l">Better but unreliable</div></div>
<div class="c"><h3>Std Conformal</h3><div class="stat gn">90.0%</div><div class="stat-l">Provably ‚â• 90%</div></div>
<div class="c"><h3>Adaptive (Ours)</h3><div class="stat gn">90.2%</div><div class="stat-l">Maintains under shift</div></div>
</div>

<div class="sl">Adaptive Calibration</div><div class="st">Coverage Under Distribution Shift</div>
<div class="sd">Standard conformal fails when data shifts. Our adaptive method tracks the shift and maintains coverage.</div>
<div class="c">
<div class="ctrl">
<div><label>Shift:</label><input type="range" id="sm" min="0" max="100" value="50" oninput="uC()"><span class="rv" id="sv">0.50</span></div>
<div><label>LR:</label><select id="lr" onchange="uC()"><option value="0.001">0.001</option><option value="0.01" selected>0.01</option><option value="0.05">0.05</option></select></div>
<div><label>Target:</label><select id="tc" onchange="uC()"><option value="0.85">85%</option><option value="0.90" selected>90%</option><option value="0.95">95%</option></select></div>
</div>
<div id="cc" style="min-height:420px"></div>
</div>

<div style="margin-top:3rem"><div class="sl">Prediction Sets</div><div class="st">Set Size vs. Coverage</div></div>
<div class="g g2">
<div class="c">
<div class="ctrl"><div><label>Œ±:</label><input type="range" id="as" min="1" max="30" value="10" oninput="uS()"><span class="rv" id="av">0.10</span></div></div>
<div id="ssc" style="min-height:350px"></div>
</div>
<div class="c"><div id="rc" style="min-height:350px"></div></div>
</div>

<div style="margin-top:3rem"><div class="sl">Multi-Modal Fusion</div><div class="st">Conformal Across Modalities</div></div>
<div class="c"><div id="fc" style="min-height:400px"></div></div>

<div style="margin-top:3rem"><div class="sl">Benchmarks</div><div class="st">Evaluation</div></div>
<div class="c"><table>
<thead><tr><th>Scenario</th><th>Target</th><th>Softmax</th><th>Temp</th><th>Std</th><th>Adaptive</th><th>Set Size</th></tr></thead>
<tbody>
<tr><td>ImageNet</td><td>90%</td><td style="color:var(--d)">72%</td><td style="color:var(--w)">84%</td><td style="color:var(--a1)">90.1%</td><td style="color:var(--a1)">90.0%</td><td>3.2</td></tr>
<tr><td>ImageNet-C</td><td>90%</td><td style="color:var(--d)">58%</td><td style="color:var(--d)">67%</td><td style="color:var(--w)">82%</td><td style="color:var(--a1)">89.8%</td><td>5.1</td></tr>
<tr><td>Domain Shift</td><td>90%</td><td style="color:var(--d)">64%</td><td style="color:var(--d)">71%</td><td style="color:var(--w)">79%</td><td style="color:var(--a1)">90.3%</td><td>1.4</td></tr>
<tr><td>Multi-Modal</td><td>95%</td><td style="color:var(--d)">72%</td><td style="color:var(--w)">81%</td><td style="color:var(--a1)">94.8%</td><td style="color:var(--a1)">95.1%</td><td>2.8</td></tr>
<tr><td>Tabular</td><td>90%</td><td style="color:var(--d)">61%</td><td style="color:var(--w)">75%</td><td style="color:var(--a1)">89.7%</td><td style="color:var(--a1)">90.4%</td><td>2.1</td></tr>
<tr><td>Time Series</td><td>90%</td><td style="color:var(--d)">55%</td><td style="color:var(--d)">63%</td><td style="color:var(--d)">68%</td><td style="color:var(--a1)">89.6%</td><td>4.7</td></tr>
</tbody></table></div>

<div class="th"><h3>Theoretical Foundation</h3>
<p><strong>Coverage Guarantee:</strong> For exchangeable data, the conformal prediction set C(X‚Çô‚Çä‚ÇÅ) satisfies:</p>
<div class="eq">P(Y‚Çô‚Çä‚ÇÅ ‚àà C(X‚Çô‚Çä‚ÇÅ)) ‚â• 1 ‚àí Œ±</div>
<p>This is a <strong>finite-sample, distribution-free</strong> guarantee.</p>
<p><strong>Adaptive (Gibbs &amp; Cand√®s, 2021):</strong> Online quantile tracking: <code>qÃÇ‚Çú‚Çä‚ÇÅ = qÃÇ‚Çú ‚àí Œ∑¬∑(ùüô{Y‚Çú ‚àâ C(X‚Çú)} ‚àí Œ±)</code></p>
<p><strong>Multi-Modal (Ours):</strong> Fused score <code>s = Œ£ w·µ¢¬∑s·µ¢</code> with weights learned to minimize set size subject to the coverage constraint.</p>
</div>
</div>
<footer>Spencer Cottrell ¬∑ <a href="https://github.com/colonel1223">github.com/colonel1223</a> ¬∑ MIT ¬∑ 2026</footer>
<script>
function R(s){let x=s;return()=>{x=(x*16807)%2147483647;return(x-1)/2147483646}}
const C={bg:'#0f1623',paper:'#0f1623',grid:'#1c2a42',text:'#7b8ba2',green:'#10b981',purple:'#6366f1',warn:'#f59e0b',danger:'#ef4444'};
const L={paper_bgcolor:C.paper,plot_bgcolor:C.bg,font:{family:'JetBrains Mono',color:C.text,size:11},margin:{l:60,r:30,t:40,b:50}};

function uC(){
const sh=+document.getElementById('sm').value/100,lr=+document.getElementById('lr').value,tg=+document.getElementById('tc').value;
document.getElementById('sv').textContent=sh.toFixed(2);
const T=500,r=R(42),ss=200,steps=Array.from({length:T},(_,i)=>i);
const std=[],adp=[],sfx=[];let q=.5,w=[];
for(let t=0;t<T;t++){
const inS=t>=ss,sa=inS?sh*Math.min((t-ss)/50,1):0;
sfx.push((.72-sa*.3)+(r()-.5)*.08);
std.push((tg+.005-sa*.2)+(r()-.5)*.04);
const sc=.5+sa*.3+(r()-.5)*.2,cov=sc<=q?1:0;
q-=lr*(cov-tg);q=Math.max(.1,Math.min(.95,q));
w.push(cov);if(w.length>50)w.shift();
adp.push(w.reduce((a,b)=>a+b,0)/w.length);
}
const sm=(a,wn)=>a.map((_,i)=>{const s=Math.max(0,i-wn);const sl=a.slice(s,i+1);return sl.reduce((a,b)=>a+b,0)/sl.length});
Plotly.react('cc',[
{x:steps,y:sm(sfx,20),name:'Softmax',line:{color:C.danger,width:1.5}},
{x:steps,y:sm(std,20),name:'Standard',line:{color:C.warn,width:1.5}},
{x:steps,y:sm(adp,20),name:'Adaptive (Ours)',line:{color:C.green,width:2.5}},
{x:[0,T],y:[tg,tg],name:`Target ${(tg*100).toFixed(0)}%`,line:{color:'rgba(255,255,255,.3)',width:1,dash:'dot'}}
],{...L,title:{text:'Rolling Coverage Under Distribution Shift',font:{size:13}},xaxis:{title:'Time Step',gridcolor:C.grid},yaxis:{title:'Coverage',gridcolor:C.grid,range:[.35,1.05]},shapes:[{type:'rect',x0:ss,x1:T,y0:0,y1:1,yref:'paper',fillcolor:'rgba(239,68,68,.04)',line:{width:0}},{type:'line',x0:ss,x1:ss,y0:0,y1:1,yref:'paper',line:{color:C.danger,width:1,dash:'dash'}}],annotations:[{x:ss,y:1.03,yref:'paper',text:'‚Üê Shift ‚Üí',showarrow:false,font:{size:10,color:C.danger}}],legend:{x:.02,y:.02,bgcolor:'rgba(15,22,35,.9)',font:{size:10}}},{responsive:true,displayModeBar:false});
}

function uS(){
const al=+document.getElementById('as').value/100;document.getElementById('av').textContent=al.toFixed(2);
const r=R(99),n=300,sz=[];
for(let i=0;i<n;i++){const lam=1+(.3-al)*15;sz.push(Math.min(10,Math.max(1,Math.round(lam+(r()-.5)*lam*.8))))}
const h=Array(10).fill(0);sz.forEach(s=>h[s-1]++);const avg=sz.reduce((a,b)=>a+b,0)/n;
Plotly.react('ssc',[{x:[1,2,3,4,5,6,7,8,9,10],y:h.map(v=>v/n*100),type:'bar',marker:{color:[1,2,3,4,5,6,7,8,9,10].map(c=>c===1?C.green:c<=3?'rgba(16,185,129,.5)':'rgba(99,102,241,.4)')}}],{...L,title:{text:`Set Size (Œ±=${al.toFixed(2)}, avg=${avg.toFixed(1)})`,font:{size:12}},xaxis:{title:'Set Size',gridcolor:C.grid,dtick:1},yaxis:{title:'Freq %',gridcolor:C.grid},margin:{l:60,r:20,t:50,b:50}},{responsive:true,displayModeBar:false});
}

function iR(){
const b=10,exp=Array.from({length:b},(_,i)=>(i+.5)/b),r=R(55);
const sf=exp.map(e=>e*(.5+r()*.4)+(r()-.5)*.05),cf=exp.map(e=>e+(r()-.5)*.02);
Plotly.newPlot('rc',[
{x:[0,1],y:[0,1],mode:'lines',name:'Perfect',line:{color:'rgba(255,255,255,.2)',width:1,dash:'dot'}},
{x:exp,y:sf,mode:'lines+markers',name:'Softmax',line:{color:C.danger,width:2},marker:{size:6}},
{x:exp,y:cf,mode:'lines+markers',name:'Conformal',line:{color:C.green,width:2},marker:{size:6}}
],{...L,title:{text:'Reliability Diagram',font:{size:12}},xaxis:{title:'Predicted',gridcolor:C.grid,range:[0,1]},yaxis:{title:'Observed',gridcolor:C.grid,range:[0,1]},legend:{x:.05,y:.95,bgcolor:'rgba(15,22,35,.9)',font:{size:10}},margin:{l:60,r:20,t:50,b:50}},{responsive:true,displayModeBar:false});
}

function iF(){
const mth=['Image Only','Text Only','Tabular','Late Fusion','Score Fusion','Learned (Ours)'];
const cov=[87.2,85.8,83.1,91.5,93.2,95.1],ss=[4.8,3.2,2.9,3.5,3.1,2.8];
Plotly.newPlot('fc',[{x:ss,y:cov,text:mth,mode:'markers+text',textposition:'top center',textfont:{size:10,color:C.text},marker:{size:mth.map((_,i)=>i===5?18:12),color:mth.map((_,i)=>i===5?C.green:i>=3?C.purple:'rgba(255,255,255,.3)'),line:{color:mth.map((_,i)=>i===5?'#fff':'transparent'),width:mth.map((_,i)=>i===5?2:0)}},hovertemplate:'%{text}<br>Cov: %{y:.1f}%<br>Size: %{x:.1f}<extra></extra>'}],{...L,title:{text:'Multi-Modal Fusion (Target: 95%)',font:{size:13}},xaxis:{title:'Avg Set Size ‚Üì',gridcolor:C.grid,autorange:'reversed'},yaxis:{title:'Coverage %',gridcolor:C.grid,range:[80,97]},shapes:[{type:'line',x0:0,x1:10,y0:95,y1:95,line:{color:'rgba(255,255,255,.15)',width:1,dash:'dash'}}],showlegend:false},{responsive:true,displayModeBar:false});
}
uC();uS();iR();iF();
</script>
</body></html>
